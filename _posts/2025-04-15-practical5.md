---
title: Practical 5 - pgAdmin and normalization 
sidebar:
  nav: pract-en
aside:
  toc: true
---
# Guided Session

Example Database: PokeDB

## Connect to your postgresql server

1. Check your username
- Connect to postgres and use the following command
```javascript
\conninfo
```

## Create DigimonDB
- Create DB using pgadmin4 
  - Create DB "digiDB"
  
## Setup PokeDB

2. Create a folder called "DigiData"
3. Download csv files and create tables

    -  DigiDB_digimonlist.csv
    -  DigiDB_movelist.csv
    -  DigiDB_supportlist.csv
    

  - Create tables inside digiDB using the following SQL commands
  ```javascript
            CREATE TABLE digimon (
            number INTEGER PRIMARY KEY,
            name TEXT,
            stage TEXT,
            type TEXT,
            attribute TEXT,
            memory INTEGER,
            equip_slots INTEGER,
            lv50_hp INTEGER,
            lv50_sp INTEGER,
            lv50_atk INTEGER,
            lv50_def INTEGER,
            lv50_int INTEGER,
            lv50_spd INTEGER
        );

        CREATE TABLE moves (
            name TEXT PRIMARY KEY,
            sp_cost INTEGER,
            type TEXT,
            power INTEGER,
            attribute TEXT,
            inheritable TEXT,
            description TEXT
        );

        CREATE TABLE support_skills (
            name TEXT PRIMARY KEY,
            description TEXT
        );
    ```
  - Create the following view
  ```javascript
    create or replace view pokemon_with_type as
        select p.id, p.identifier, t.identifier as type, c.identifier as color, s.identifier as shape
        from pokemon p
        inner join pokemon_types pt on p.id = pt.id
        inner join types t on pt.type_id = t.id
        inner join pokemon_species ps on p.species_id = ps.id
        inner join pokemon_colors c on ps.color_id = c.id
        inner join pokemon_shapes s on ps.shape_id = s.id;
  ```
  - Import csv files into tables using pgadmin
    - Import:
      - DigiDB_digimonlist.csv into digimon table
      - DigiDB_movelist.csv into moves table
      -  DigiDB_supportlist.csv into support_skills table
  
     Example Tutorial
     
     - Right-click on the table
  
    <img src="https://raw.githubusercontent.com/palden518/DBS101.github.io/master/assets/images/pract5_1.png">

     - Choose import/export data

    <img src="https://raw.githubusercontent.com/palden518/DBS101.github.io/master/assets/images/pract5_2.png">

     - Choose the file csv file to import

    <img src="https://raw.githubusercontent.com/palden518/DBS101.github.io/master/assets/images/pract5_3.png">

     - Check columns to be imported
  
    <img src="https://raw.githubusercontent.com/palden518/DBS101.github.io/master/assets/images/pract5_4.png">

     - Check options as Header -- Identifies headers from the csv file to add entries/tuples into table
  
    <img src="https://raw.githubusercontent.com/palden518/DBS101.github.io/master/assets/images/pract5_5.png">

4. Create a view EggDigimon in the database, add the following as code to retrieve only baby digimon
   ```javascript
    SELECT 
        d.name AS digimon_name,
        d.stage,
        d.attribute AS digimon_attribute,
        m.name AS move_name,
        m.sp_cost,
        m.type AS move_type,
        m.power,
        m.attribute AS move_attribute,
        m.description
    FROM digimon d
    JOIN moves m 
        ON m.name LIKE '% I'
    AND d.attribute = m.attribute
    WHERE d.stage = 'Baby';
   ```
5. Create a view FireDigimon in the database, add the following as code to retrieve only fire type digimon and give them moves based on their evolution stage
    ```javascript
        SELECT 
        d.name AS digimon_name,
        d.stage,
        d.attribute AS digimon_attribute,
        m.name AS move_name,
        m.sp_cost,
        m.type AS move_type,
        m.power,
        m.attribute AS move_attribute,
        m.description
    FROM digimon d
    JOIN moves m 
    ON d.attribute = m.attribute
    AND (
        (d.stage = 'In-Training' AND m.name LIKE '% I')
        OR (d.stage = 'Rookie' AND (m.name LIKE '% I' OR m.name LIKE '% II'))
        OR (d.stage IN ('Champion', 'Ultimate', 'Mega') AND m.name LIKE '% III')
    )
    WHERE d.attribute = 'Fire'::text;
    ```
# Practical 5 Exercise

